import { JMSNavSetting } from '@/icons'

# Authentication


This topic describes how to configure third-party authentication services and related user authentication settings.

## Configure email suffix

If the user from the third-party authentication does not have an email field configured, the email suffix is used to automatically generate the user email address by combining the username with the suffix.

1. In the upper-right corner of any page in JumpServer, click <img src="/images/docs/svg/nav-setting.svg" alt="x" width="15" style={{ display: "inline-block" }}/>.
<img src="/images/docs/admin-guides/system-settings/nav-settings.png" alt="image" width="450"/>
2. Navigate to **System settings > Authentication > Basic**.
3. In the **Email suffix** field, enter the email suffix (such as `example.com`).
<img src="/images/docs/admin-guides/system-settings/auth/email-suffix.png" alt="image" width="450"/>
4. Click **Submit**.

## Modify the forgot password URL

When the user clicks the **Forgot password?** link on the login page, they will be redirected to this URL.
<img src="/images/docs/admin-guides/system-settings/auth/login-page-forgot-password.png" alt="image" width="350"/>

1. In the upper-right corner of any page in JumpServer, click <img src="/images/docs/svg/nav-setting.svg" alt="x" width="15" style={{ display: "inline-block" }}/>.
<img src="/images/docs/admin-guides/system-settings/nav-settings.png" alt="image" width="450"/>
2. Navigate to **System settings > Authentication > Basic**.
3. In the **Forgot password URL** field, enter the URL for the forgot password link.
<img src="/images/docs/admin-guides/system-settings/auth/forgot-password-url.png" alt="image" width="450"/>
4. Click **Submit**.

## Enable or disable user login redirection
If enabled, when an unauthenticated user accesses JumpServer, they will be redirected to a prompt page where they can choose to **Cancel** or **Confirm** the redirection. 
<img src="/images/docs/admin-guides/system-settings/auth/redirecting.png" alt="image" width="450"/>

If disabled, the user will be directly redirected to the third-party authentication page.

1. In the upper-right corner of any page in JumpServer, click <img src="/images/docs/svg/nav-setting.svg" alt="x" width="15" style={{ display: "inline-block" }}/>.
<img src="/images/docs/admin-guides/system-settings/nav-settings.png" alt="image" width="450"/>
2. Navigate to **System settings > Authentication > Basic**.
3. In the **Login redirection** field, enable or disable the user login redirection.
<img src="/images/docs/admin-guides/system-settings/auth/login-redirection.png" alt="image" width="450"/>
4. Click **Submit**.

## Configure LDAP server
1. In the upper-right corner of any page in JumpServer, click <img src="/images/docs/svg/nav-setting.svg" alt="x" width="15" style={{ display: "inline-block" }}/>.
<img src="/images/docs/admin-guides/system-settings/nav-settings.png" alt="image" width="450"/>
2. Navigate to **System settings > Authentication > LDAP**.
3. In the **LDAP** field, enable or disable the LDAP authentication.
4. In the **Server** field, enter the LDAP server URI, such as `ldap://example.com:389` or `ldaps://example.com:636`.
5. In the **Bind DN** field, enter the distinguished name for binding to the LDAP server, such as `cn=admin,dc=example,dc=com`.
6. In the **Password** field, enter the bind user password, used with `Bind DN` for authentication.
7. In the **Search OU** field, enter the search OU to specify where to start searching for users, use `|` to separate multiple values. Such as `ou=users,dc=example,dc=com | ou=tech,dc=example,dc=com`.
<img src="/images/docs/admin-guides/system-settings/auth/ldap-search.png" alt="image" width="550"/>
8. In the **Search filter** field, enter the filter expression for searching LDAP users. Such as `(cn=%(user)s)`, `(uid=%(user)s)`, or `(sAMAccountName=%(user)s)`.
9. In the **User attribute** field, enter the user attribute mapping. The key is the JumpServer user attribute name (Available keys: `name`, `username`, `email`, `groups`), and the value is the LDAP user attribute name.
10. In the **Connect timeout (s)** field, enter the LDAP connection timeout in seconds.
11. In the **Search paged size (piece)** field, enter the page size for searching users.
12. In the **User DN cache timeout (s)** field, enter the cache duration for user DN (seconds) to improve login authentication speed. Submit the form to clear the cache if any user DN changes.
13. Click **Submit**.

### Test LDAP connection
1. In the upper-right corner of any page in JumpServer, click <img src="/images/docs/svg/nav-setting.svg" alt="x" width="15" style={{ display: "inline-block" }}/>.
<img src="/images/docs/admin-guides/system-settings/nav-settings.png" alt="image" width="450"/>
2. Navigate to **System settings > Authentication > LDAP**.
3. Scroll to the bottom of the page and click the **Test connection** button.
4. If the connection is successful, a popup at the top of the page will display the number of matched users.
<img src="/images/docs/admin-guides/system-settings/auth/ldap-test-success.png" alt="image" width="450"/>
5. If the connection fails, please adjust the configuration parameters based on the error message and try again.

### Test LDAP user login
1. In the upper-right corner of any page in JumpServer, click <img src="/images/docs/svg/nav-setting.svg" alt="x" width="15" style={{ display: "inline-block" }}/>.
<img src="/images/docs/admin-guides/system-settings/nav-settings.png" alt="image" width="450"/>
2. Navigate to **System settings > Authentication > LDAP**.
3. Complete the LDAP configuration and click **Submit**, then test the connection successfully.
4. Scroll to the bottom of the page and click the **Test login** button.
5. In the popup, enter the LDAP username and password, then click **Confirm**.
<img src="/images/docs/admin-guides/system-settings/auth/ldap-test-login-popup.png" alt="image" width="650"/>

### Import LDAP users
1. In the upper-right corner of any page in JumpServer, click <img src="/images/docs/svg/nav-setting.svg" alt="x" width="15" style={{ display: "inline-block" }}/>.
<img src="/images/docs/admin-guides/system-settings/nav-settings.png" alt="image" width="450"/>
2. Navigate to **System settings > Authentication > LDAP**.
3. Complete the LDAP configuration and click **Submit**, then test the connection successfully.
4. Scroll to the bottom of the page and click the **User import** button.
5. In the popup, you can perform the following actions:
    <img src="/images/docs/admin-guides/system-settings/auth/ldap-import-user.png" alt="image" width="650"/>
    1. At the bottom of the table, click the **Sync users** button to sync LDAP users to the current table.
    2. At the bottom left of the table, in the **Import organization** field, select one or more organizations to be imported.
    3. In the table, select the users you want to import, then click the **Import** button at the bottom to proceed.
    4. At the bottom of the table, click **Import all** to import all users in the table.
    5. At the bottom of the table, click **Cancel** to close the popup.

### Set up LDAP user sync
1. In the upper-right corner of any page in JumpServer, click <img src="/images/docs/svg/nav-setting.svg" alt="x" width="15" style={{ display: "inline-block" }}/>.
<img src="/images/docs/admin-guides/system-settings/nav-settings.png" alt="image" width="450"/>
2. Navigate to **System settings > Authentication > LDAP**.
3. Complete the LDAP configuration and click **Submit**, then test the connection successfully.
4. Scroll to the bottom of the page and click the **Sync settings** button.
5. In the popup, you can perform the following actions:
    <img src="/images/docs/admin-guides/system-settings/auth/ldap-sync-settings.png" alt="image" width="550"/>
    1. In the **Organization** field, Select one or more organizations, and the users will be synced to these organizations.
    2. In the **Periodic** field, enable or disable the periodic sync.
    3. Optionally, In the **Crontab** field, enter the crontab expression for the periodic sync. (If empty, `Interval` will be used.)
    4. Optionally, in the **Interval** field, enter the sync interval in hour. (If `Crontab` has a value, prefer using crontab.)
    5. In the **Recipients** fields, select one or more users to receive the sync result.
    6. Click **Submit** to save the settings.

## Configure LDAP HA server
1. In the upper-right corner of any page in JumpServer, click <img src="/images/docs/svg/nav-setting.svg" alt="x" width="15" style={{ display: "inline-block" }}/>.
<img src="/images/docs/admin-guides/system-settings/nav-settings.png" alt="image" width="450"/>
2. Navigate to **System settings > Authentication > LDAP HA**.
3. LDAP HA configuration and other operations, please refer to the [Configure LDAP Server](/docs/system-settings/authentication#configure-ldap-server).

## Configure CAS server
1. In the upper-right corner of any page in JumpServer, click <img src="/images/docs/svg/nav-setting.svg" alt="x" width="15" style={{ display: "inline-block" }}/>.
<img src="/images/docs/admin-guides/system-settings/nav-settings.png" alt="image" width="450"/>
2. Navigate to **System settings > Authentication > CAS**.
3. In the **CAS** field, enable or disable the CAS authentication.
4. In the **Server** field, enter the CAS server URI, such as `https://example.com/cas`.
5. In the **Proxy server** field,  enter the CAS proxy server URI if behind a proxy. For example, if the host listens on `http://foo.bar:8080` but requests use `https://foo.bar:8443`, enter `https://foo.bar:8443`.
6. In the **Version** field, enter the CAS protocol version (Supported versions: `1`, `2`, `3`, `CAS_2_SAML_1_0`).
7. In the **User attribute** field, enter the user attribute mapping. The key is the CAS user attribute name, and the value is the JumpServer user attribute name (Available values: `name`, `username`, `email`, `groups`).
<img src="/images/docs/admin-guides/system-settings/auth/cas-user-attribute.png" alt="image" width="550"/>
8. In the **Organization** field, after authentication and creation, the user will be added to the selected organization.
9. In the **Create user** field, enable or disable user creation on CAS authentication success. If disabled and the user does not exist, authentication will fail.
10. In the **Logout completely** field, if disabled, logging out of the application won’t log the user out of CAS as well.
11. Click **Submit**.

## Configure Passkey server

1. In the upper-right corner of any page in JumpServer, click <img src="/images/docs/svg/nav-setting.svg" alt="x" width="15" style={{ display: "inline-block" }}/>.
<img src="/images/docs/admin-guides/system-settings/nav-settings.png" alt="image" width="450"/>
2. Navigate to **System settings > Authentication > Passkey**.
3. In the **Passkey** field, enable or disable the Passkey authentication.
4. In the **FIDO server ID** field, enter the full domain name of JumpServer. If not set, it defaults to the request host and matches domains in `DOMAINS` from `config.txt` file. If there are multiple domains, separate them with commas.
5. In the **FIDO server name** field, enter the server name, the default value is `JumpServer`.

## Configure OIDC server

## Configure SAML2 server

## Configure OAuth2 server

## Configure WeCOM server

## Configure Dingtalk server

## Configure FeiShu server

## Configure Lark server

## Configure Slack server

## Configure RADIUS server